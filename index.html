<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <title>Globe N&B Minimaliste avec Épingles</title>
  <style>
    html, body { margin: 0; height: 100%; }
    #globeViz { width: 100vw; height: 100vh; background: #fff; }
  </style>
  <script src="https://unpkg.com/three@0.150.0/build/three.min.js"></script>
  <script src="https://unpkg.com/three@0.150.0/examples/js/controls/OrbitControls.js"></script>
</head>
<body>
<div id="globeViz"></div>
<script>
// Texture Terre N&B minimaliste
const earthTextureUrl = "https://upload.wikimedia.org/wikipedia/commons/7/7c/Earth_map_bw.png";

const scene = new THREE.Scene();
scene.background = new THREE.Color(0xffffff);

const camera = new THREE.PerspectiveCamera(45, window.innerWidth/window.innerHeight, 0.1, 1000);
camera.position.set(0, 0, 3);

const renderer = new THREE.WebGLRenderer({antialias: true});
renderer.setSize(window.innerWidth, window.innerHeight);
renderer.setClearColor(0xffffff, 1);
document.getElementById('globeViz').appendChild(renderer.domElement);

const controls = new THREE.OrbitControls(camera, renderer.domElement);
controls.enableDamping = true;
controls.dampingFactor = 0.1;
controls.enablePan = false;
controls.minDistance = 2;
controls.maxDistance = 6;

// Lumière neutre
const ambient = new THREE.AmbientLight(0xffffff, 0.7);
scene.add(ambient);
const dir = new THREE.DirectionalLight(0xffffff, 0.8);
dir.position.set(2, 1, 2);
scene.add(dir);

const globeRadius = 1;
const geometry = new THREE.SphereGeometry(globeRadius, 64, 64);

new THREE.TextureLoader().load(earthTextureUrl, function(texture) {
  const material = new THREE.MeshPhongMaterial({
    map: texture,
    color: 0xffffff
  });
  const globe = new THREE.Mesh(geometry, material);
  scene.add(globe);

  // Épingles minimalistes (ronds noirs)
  const pinsData = [
    { lat: 48.8566, lng: 2.3522, name: "Paris" },
    { lat: 52.52, lng: 13.405, name: "Berlin" },
    { lat: 40.7128, lng: -74.006, name: "New York" }
  ];
  pinsData.forEach(p => {
    const phi = (90 - p.lat) * Math.PI / 180;
    const theta = (p.lng + 180) * Math.PI / 180;
    const R = globeRadius;

    const x = R * Math.sin(phi) * Math.cos(theta);
    const y = R * Math.cos(phi);
    const z = R * Math.sin(phi) * Math.sin(theta);

    // Épingle minimaliste : sphère noire
    const pinGeo = new THREE.SphereGeometry(0.025, 12, 12);
    const pinMat = new THREE.MeshBasicMaterial({ color: 0x111111 });
    const pin = new THREE.Mesh(pinGeo, pinMat);
    pin.position.set(x * 1.03, y * 1.03, z * 1.03);
    scene.add(pin);

    // Label minimaliste en N&B
    const canvas = document.createElement('canvas');
    canvas.width = 80;
    canvas.height = 24;
    const ctx = canvas.getContext('2d');
    ctx.font = 'bold 14px Arial';
    ctx.fillStyle = "#111";
    ctx.textAlign = "left";
    ctx.fillText(p.name, 6, 18);
    const textureLabel = new THREE.CanvasTexture(canvas);
    const spriteMat = new THREE.SpriteMaterial({ map: textureLabel, transparent: true });
    const sprite = new THREE.Sprite(spriteMat);
    sprite.scale.set(0.22, 0.065, 1);
    sprite.position.set(x * 1.09, y * 1.09, z * 1.09);
    scene.add(sprite);
  });

  animate();
});

function animate() {
  requestAnimationFrame(animate);
  controls.update();
  renderer.render(scene, camera);
}

window.addEventListener('resize', () => {
  camera.aspect = window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
});
</script>
</body>
</html>
